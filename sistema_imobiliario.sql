CREATE DATABASE SISTEMA_GESTAO_IMOBILIARIA_2019;
USE SISTEMA_GESTAO_IMOBILIARIA_2019; 
CREATE TABLE TBL_ADM_IMOBILIARIA (
  ID_IMOBILIARIA INT NOT NULL AUTO_INCREMENT,
  ENDERECO VARCHAR(25) not NULL,
  CNPJ VARCHAR(25) not NULL,
  IE VARCHAR(25) not NULL,
  PRIMARY KEY(ID_IMOBILIARIA)
); 
CREATE TABLE TBL_PROPRIETARIO (
  ID_PROPRIETARIO INT NOT NULL AUTO_INCREMENT,
  TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA INT NOT NULL,
  ENDERECO VARCHAR(25) not NULL,
  RG VARCHAR(25) not NULL,
  CPD VARCHAR(25) not NULL,
  PRIMARY KEY(ID_PROPRIETARIO),
  CONSTRAINT TBL_PROPIEATRIO_FKINDEX1 FOREIGN KEY (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA) REFERENCES TBL_ADM_IMOBILIARIA 
(ID_IMOBILIARIA)
);
CREATE TABLE TBL_IMOVEL (
  ID_IMOVEL INT NOT NULL AUTO_INCREMENT,
  TBL_PROPRIETARIO_ID_PROPRIETARIO INT(255) NOT NULL,
  INSCRICAO_MUNICIPAL_IMOVEL VARCHAR(25) not NULL,
  PRIMARY KEY(ID_IMOVEL),
  CONSTRAINT TBL_IMOVEL_FKINDEX1 FOREIGN KEY (TBL_PROPRIETARIO_ID_PROPRIETARIO) REFERENCES TBL_PROPRIETARIO (ID_PROPRIETARIO) 
);
CREATE TABLE TBL_CLIENTE (
  ID_CLIENTE INT NOT NULL AUTO_INCREMENT,
  TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA INT NOT NULL,
  TBL_IMOVEL_ID_IMOVEL INT NOT NULL,
  NOME_CLIENTE VARCHAR(25) not NULL,
  ENDERECO VARCHAR(25) not NULL,
  CPF VARCHAR(25) not NULL,
  PRIMARY KEY(ID_CLIENTE),
  CONSTRAINT TBL_CLIENTE_FKINDEX1 FOREIGN KEY (TBL_IMOVEL_ID_IMOVEL) REFERENCES TBL_IMOVEL (ID_IMOVEL),
  CONSTRAINT TBL_CLIENTE_FKINDEX2 FOREIGN KEY (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA) REFERENCES TBL_ADM_IMOBILIARIA (ID_IMOBILIARIA)
  
);
CREATE TABLE TBL_CONTATO (
    ID_CONTATO INT PRIMARY KEY auto_increment NOT NULL,
    TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA INT NOT NULL,
    TBL_CLIENTE_TBL_IMOVEL_ID_IMOVEL INT NOT NULL,
    TBL_CLIENTE_ID_CLIENTE INT NOT NULL,
    TBL_PROPRIETARIO_ID_PROPRIETARIO INT NOT NULL,
    TEL1 VARCHAR(255) NOT NULL,
    TEL2 VARCHAR(255) NOT NULL,
    CONSTRAINT IMOBILIARA  foreign key (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA) REFERENCES TBL_ADM_IMOBILIARIA(ID_IMOBILIARIA),
    CONSTRAINT IMOVEL  foreign key (TBL_CLIENTE_TBL_IMOVEL_ID_IMOVEL) REFERENCES TBL_IMOVEL(ID_IMOVEL),
    CONSTRAINT CLIENTE  foreign key (TBL_CLIENTE_ID_CLIENTE) REFERENCES TBL_CLIENTE(ID_CLIENTE),
    CONSTRAINT PROPRIEATRIO  foreign key (TBL_PROPRIETARIO_ID_PROPRIETARIO) REFERENCES TBL_PROPRIETARIO(ID_PROPRIETARIO)
    );
   
INSERT INTO tbl_adm_imobiliaria (ENDERECO,CNPJ,IE) VALUES ("Luis Braz","123456789","987654321");


INSERT INTO tbl_adm_imobiliaria (ENDERECO,CNPJ,IE) VALUES ("Terezinha Machado","789123456","123789654");
INSERT INTO tbl_adm_imobiliaria (ENDERECO,CNPJ,IE) VALUES ("Machado de Assis","321456987","789564231");
INSERT INTO TBL_PROPRIETARIO (tbl_adm_imobiliaria_id_imobiliaria,ENDERECO,RG,CPD) VALUES ("1","Otavio de Carvalho","325587","445655889"); 
INSERT INTO TBL_PROPRIETARIO (tbl_adm_imobiliaria_id_imobiliaria,ENDERECO,RG,CPD) VALUES ("2","Carvalho de Otavio","321654987","123456887");
INSERT INTO TBL_PROPRIETARIO (tbl_adm_imobiliaria_id_imobiliaria,ENDERECO,RG,CPD) VALUES ("3","Assis Braz","123456788","456789123");
INSERT INTO TBL_IMOVEL (tbl_proprietario_ID_PROPRIETARIO,INSCRICAO_MUNICIPAL_IMOVEL) VALUES ("1","5879");
INSERT INTO TBL_IMOVEL (tbl_proprietario_ID_PROPRIETARIO,INSCRICAO_MUNICIPAL_IMOVEL) VALUES ("2","60002");
INSERT INTO TBL_IMOVEL (tbl_proprietario_ID_PROPRIETARIO,INSCRICAO_MUNICIPAL_IMOVEL) VALUES ("3","70004");
INSERT INTO TBL_CLIENTE (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA,tbl_imovel_ID_IMOVEL,NOME_CLIENTE,
ENDERECO,CPF) VALUES ("1","1","José Cleverton","Jacinto Plinio","123654777");

INSERT INTO TBL_CLIENTE (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA,tbl_imovel_ID_IMOVEL,NOME_CLIENTE,ENDERECO,CPF) VALUES ("2","2","Gabriela Silva","Kleber Peixoto","888555222");
INSERT INTO TBL_CLIENTE (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA,tbl_imovel_ID_IMOVEL,NOME_CLIENTE,ENDERECO,CPF) VALUES ("3","3","Jose Mel","Paulista","444777111");
INSERT INTO TBL_CONTATO (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA,TBL_CLIENTE_TBL_IMOVEL_ID_IMOVEL,TBL_CLIENTE_ID_CLIENTE,TBL_PROPRIETARIO_ID_PROPRIETARIO,TEL1,TEL2) VALUES ("1","1","1","1","56618855","9487712");
INSERT INTO TBL_CONTATO (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA,TBL_CLIENTE_TBL_IMOVEL_ID_IMOVEL,TBL_CLIENTE_ID_CLIENTE,TBL_PROPRIETARIO_ID_PROPRIETARIO,TEL1,TEL2) VALUES ("2","2","2","2","56625588","9487722");
INSERT INTO TBL_CONTATO (TBL_ADM_IMOBILIARIA_ID_IMOBILIARIA,TBL_CLIENTE_TBL_IMOVEL_ID_IMOVEL,TBL_CLIENTE_ID_CLIENTE,TBL_PROPRIETARIO_ID_PROPRIETARIO,TEL1,TEL2) VALUES ("3","3","3","3","56638782","9487655");

SELECT * FROM TBL_ADM_IMOBILIARIA WHERE ENDERECO Like '%lUIS BRAZ%';
SELECT * FROM TBL_IMOVEL ORDER BY INSCRICAO_MUNICIPAL_IMOVEL;
SELECT RG,CPD FROM TBL_PROPRIETARIO WHERE RG = '325587' AND CPD = '445655889';
SELECT NOME_CLIENTE,CPF FROM TBL_CLIENTE WHERE NOME_CLIENTE = 'JOSÉ CLEVERTON' OR CPF = '123654777' ;
SELECT * FROM TBL_IMOVEL AS I JOIN TBL_PROPRIETARIO AS P ON I.ID_IMOVEL = P.ID_PROPRIETARIO;
SELECT * FROM TBL_CONTATO WHERE TEL1 GROUP BY TEL2;
SELECT * FROM TBL_CLIENTE ORDER BY NOME_CLIENTE DESC;
SELECT * FROM TBL_CLIENTE ORDER BY NOME_CLIENTE ASC;
SELECT * FROM TBL_PROPRIETARIO WHERE ENDERECO LIKE 'A%';

CREATE VIEW VW_ADM_IMOBILIARIA
AS SELECT *
FROM TBL_ADM_IMOBILIARIA;
SELECT * FROM VW_ADM_IMOBILIARIA;

CREATE VIEW VW_IMOVEL
AS SELECT 
TBL_PROPRIETARIO_ID_PROPRIETARIO,INSCRICAO_MUNICIPAL_IMOVEL
FROM TBL_IMOVEL;
SELECT * FROM VW_IMOVEL; 


CREATE VIEW VW_CLIENTE
AS SELECT NOME_CLIENTE , CPF
FROM TBL_CLIENTE;
SELECT * FROM VW_CLIENTE;


CREATE VIEW VW_CONTATO
AS SELECT TEL1
FROM TBL_CONTATO;
SELECT * FROM VW_CONTATO;


